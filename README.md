こちらのスクリプトを更新してから1年近く経って、今更ながらメモを書き残している次第です。

以下、このスクリプトの品質は不明であることと、その経緯の説明となっています。
↓↓↓
大きく書き換えたのが
    stGTI := Buffer(cbSize, 0)
    NumPut("UInt", cbSize, stGTI, 0)
の箇所だったと記憶しています。

もともとv1にはBufferというカプセル化するためのオブジェクトがなかったようです。
しかし公式ドキュメントのv2のNumPutの説明をみると、引数としてBufferオブジェクトを求めているようでしたので、
試しにv1においてNumPutの引数であったstGTIをBufferでラップしてみたら動いた…という感じです。

私としても趣味程度にahkを触っており、低レベルに詳しいわけでもありません。
もっと技術に詳しい方なら正しい実装など分かるかと思います。
コードの変更などはこちらも助かりますので、ご遠慮なく行っていただければと思います。

今まで説明も書かずネットに放流させてたままですみませんでした。
それまで多くの時間を試行錯誤に割いており、疲れ果てていたのもありますが、良くなかったと反省しております。
ここまでお読みいただいてありがとうございます。
